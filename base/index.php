<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <meta name="og:title" content="Switchboo"/>
    <meta name="description" content="Switchboo gets you cheaper energy bills forever. When your deal ends, we'll automatically switch you again. You don't have to do a thing. And our service is free!"/>
    <meta name="subject" content="Switchboo">
    
    <title>Switchboo</title>
    <meta name="og:title" content="Switchboo"/>
    <meta name="subject" content="Switchboo">
    <meta name="description" content="Switchboo gets you cheaper energy bills forever. When your deal ends, we'll automatically switch you again. You don't have to do a thing. And our service is free!"/>
    <meta name="og:description" content="Switchboo gets you cheaper energy bills forever. When your deal ends, we'll automatically switch you again. You don't have to do a thing. And our service is free!"/>
    
    <meta property="og:image" content="https://switchboo.com/assets/images/SB-display.png" />

    
    
    
    <link rel="shortcut icon" href="../assets/favicon/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="../assets/favicon/favicon.ico">
	<link rel="icon" type="image/png" sizes="196x196" href="../assets/favicon/favicon-192.png">
	<link rel="icon" type="image/png" sizes="160x160" href="../assets/favicon/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="../assets/favicon/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="../assets/favicon/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="../assets/favicon/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="../assets/favicon/favicon-16.png">
	<link rel="apple-touch-icon" href="../assets/favicon/favicon-57.png">
	<link rel="apple-touch-icon" sizes="114x114" href="../assets/favicon/favicon-114.png">
	<link rel="apple-touch-icon" sizes="72x72" href="../assets/favicon/favicon-72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="../assets/favicon/favicon-144.png">
	<link rel="apple-touch-icon" sizes="60x60" href="../assets/favicon/favicon-60.png">
	<link rel="apple-touch-icon" sizes="120x120" href="../assets/favicon/favicon-120.png">
	<link rel="apple-touch-icon" sizes="76x76" href="../assets/favicon/favicon-76.png">
	<link rel="apple-touch-icon" sizes="152x152" href="../assets/favicon/favicon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="../assets/favicon/favicon-180.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
	<meta name="msapplication-TileImage" content="../assets/favicon/favicon-144.png">
	<meta name="msapplication-config" content="../assets/favicon/browserconfig.xml">

    
    <script src="https://kit.fontawesome.com/28d22f76c2.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <link rel="stylesheet" href="../assets/css/fonts.css">
    <link href="main.css" rel="stylesheet">



</head>
    
<body id="home-body">
    
  

   <!-- Navigation -->
    <nav class="navbar navbar-expand-md">
        <div class="container-fluid">
            <div class="row" id="nav-row">
                <div class="col-6 col-md-3 offset-md-1 col-lg-3 offset-lg-2 col-xl-4 offset-xl-0">
                    <a class="navbar-brand black">
                        <img src="https://switchboo.com/assets/images/switchboo_pink.png" class="img-fluid"/>
                    </a>
                </div>
            </div>
        </div>
    </nav>
    
    <div class="container-fluid" id="title-container">
        <div class="row">
            <div class="col-12 text-center">
                <span class="title">Get a quote <br><span class="pink">in just 30 seconds</span></span>
            </div>
        </div>
    </div>
    
    <div class="container-fluid" id="form-container">
        <form id="main-form">
            <div class="row">
                <div class="col-12">
                    <div class="form-group">
                        <label for="postcode">Your postcode</label>
                        <input type="text" class="form-control" id="postcode" aria-describedby="postcode" required="required" pattern="^[-a-zA-Z0-9 .'&ñçàáâãäèéêëìíîïòóôõöùúûü]{2,50}$">
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-12">
                    <div class="form-group">
                        <label for="email">Your email</label>
                        <input type="email" class="form-control" id="email" aria-describedby="email" required="required" pattern="^((([a-zA-Z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-zA-Z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-zA-Z]|\d|-||_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+|(([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+([a-zA-Z]+|\d|-|\.{0,1}|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])?([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$">
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-12">
                    <div class="form-group">
                        <label for="phone">Your phone number</label>
                        <input type="text" class="form-control" id="phone" aria-describedby="phone" required="required" pattern="^0[0-9 ]{9,24}$">
                    </div>
                </div>
            </div>
            
            
            <div class="row">
                <div class="col-12">
                    <button type="submit" type="button" id="btn-submit" class="btn btn-primary">
                        <span id="start-text">Start quote</span>
                    </button>
                </div>
            </div>
            
            
            <div class="row" id="disclaimer">
                <div class="col-12 text-center">
                    <span>Your details are safe with us! Switchboo will only contact you once if you need help with your energy quote.</span>
                </div>
            </div>
            
            
        </form>
    </div>

</body>
    
    
<script src="../assets/vendor/jquery/jquery.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="../assets/vendor/jquery/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.1/jquery.validate.min.js"></script>
<script>
$( document ).ready(function() {
    
    
    //var endpoint = "https://api.switchboo.com";
    var endpoint = "http://localhost:3000";
    
    $('input').bind('invalid', function() {
      return false;
    });
    
    
    $('input').on('input',function(){  
        if ($(this).attr("pattern") != undefined) {
            if (this.reportValidity() === true && $(this).val() !== "") {
                $(this).css('background-image', 'url(../assets/images/checkmark.png)');
            } else {
                $(this).css('background-image', 'url(../assets/images/delete-sign.png)');
            }
        }
    });
    
    
    $('#main-form').on('submit', function(e) { 
        e.preventDefault();
        $('#start-text').html('<i class="fas fa-spinner fa-pulse"></i>');        
        
        $.get(endpoint + "/init/", function( data ) {    
            init_data = JSON.parse(data);
            init_data['marketing'] = 1;
            init_data['ref'] = "NHS";
            init_data['phoneno'] = $('#phone').val();
            
            console.log(init_data);
            if (document.getElementById("main-form").checkValidity() == true) {
                
                let postcode = $('#postcode').val();
                let email = $('#email').val();
                
                if (updateTemplate("supplyPostcode","postcode", postcode)) {
                    if (updateTemplate("references","customerReference",email)) {   
                        
                        $.ajax({
                            url: endpoint + "/postcode",
                            type:"POST",
                            data:JSON.stringify(init_data),
                            contentType:"application/json; charset=utf-8",
                            dataType:"json",
                            success: function(data){
                                console.log(data);
                                if (!data.hasOwnProperty("errors")) {
                                    sessionStorage.setItem("email", email);
                                    sessionStorage.setItem("supplier-template", JSON.stringify(data));
                                    window.location.replace("../energy/1/");
                                } else {
                                    alert(data['errors']['0']['message']['text']);
                                    $('#start-text').html('Start quote');
                                }
                            }
                        });
                        
                        
                    } else {
                        $('#start-text').html('Start quote');
                    }
                } else {
                    $('#start-text').html('Start quote');
                }
            } else {
                $('#start-text').html('Start quote');
            }
        });
        
    });
    
    
    
    
    function updateTemplate(group_name, item_name, item_value) {
        let response = false;
        $.each(init_data['data-template']['groups'], function(index, val) {
            if (val['name'] === group_name) {
                $.each(init_data['data-template']['groups'][index]['items'], function(indexx, value) {
                    console.log(indexx, value);
                    if (value['name'] === item_name) {
                        value['data'] = item_value;
                        response = true;
                    }
                });
            }  
        });
        return response;
    }
    
    
    
    
});
    
    
    
</script>